---
phase: 07-deprecate-npx-support
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - skills/kata-updating/SKILL.md
  - hooks/kata-check-update.js
  - hooks/kata-npm-statusline.js
  - .github/workflows/publish.yml
autonomous: true

must_haves:
  truths:
    - "NPX update skill is deleted"
    - "NPX update check hook is deleted"
    - "NPX statusline hook is deleted"
    - "Automated NPM publish workflow is deleted"
  artifacts:
    - path: "skills/kata-updating"
      provides: "Deleted directory"
      exists: false
    - path: "hooks/kata-check-update.js"
      provides: "Deleted file"
      exists: false
    - path: "hooks/kata-npm-statusline.js"
      provides: "Deleted file"
      exists: false
    - path: ".github/workflows/publish.yml"
      provides: "Deleted workflow"
      exists: false
  key_links: []
---

<objective>
Delete NPX-specific files that are no longer needed.

Purpose: With plugin-only distribution, NPX update checking, NPX statusline, and automated NPM publishing are obsolete.

Output: 4 files/directories deleted from repository.
</objective>

<execution_context>
These files exist solely for NPX distribution:
- `skills/kata-updating/` - Skill for updating NPX installation
- `hooks/kata-check-update.js` - SessionStart hook that checks npm registry for updates
- `hooks/kata-npm-statusline.js` - Statusline hook for NPX installations
- `.github/workflows/publish.yml` - GitHub Action that auto-publishes to npm on version bump
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Delete NPX-specific files</name>
  <files>
    skills/kata-updating/
    hooks/kata-check-update.js
    hooks/kata-npm-statusline.js
    .github/workflows/publish.yml
  </files>
  <action>
Use git rm to delete the following files/directories:

```bash
git rm -r skills/kata-updating
git rm hooks/kata-check-update.js
git rm hooks/kata-npm-statusline.js
git rm .github/workflows/publish.yml
```

These files are NPX-specific:
- `kata-updating` skill: Only relevant for NPX users to update their installation
- `kata-check-update.js`: SessionStart hook that checks npm registry - not needed for plugins
- `kata-npm-statusline.js`: Statusline for NPX installations showing update availability
- `publish.yml`: Automated npm publish on main push - replaced by manual final deprecation publish
  </action>
  <verify>
```bash
# Verify files are deleted
ls skills/kata-updating 2>/dev/null || echo "kata-updating deleted OK"
ls hooks/kata-check-update.js 2>/dev/null || echo "kata-check-update.js deleted OK"
ls hooks/kata-npm-statusline.js 2>/dev/null || echo "kata-npm-statusline.js deleted OK"
ls .github/workflows/publish.yml 2>/dev/null || echo "publish.yml deleted OK"

# Verify git staging
git status --short | grep -E "(kata-updating|kata-check-update|kata-npm-statusline|publish.yml)"
# Should show "D " prefix for deleted files
```
  </verify>
  <done>4 NPX-specific files/directories deleted and staged for commit</done>
</task>

<task type="auto">
  <name>Task 2: Update build.js PLUGIN_EXCLUDES</name>
  <files>scripts/build.js</files>
  <action>
The build.js has PLUGIN_EXCLUDES that skip kata-updating for plugin builds:

```javascript
const PLUGIN_EXCLUDES = [
  'commands/kata/update.md',
  'skills/kata-updating',
];
```

Since kata-updating is now deleted entirely, remove it from PLUGIN_EXCLUDES:

```javascript
const PLUGIN_EXCLUDES = [
  'commands/kata/update.md',  // This can also be removed if commands/kata/ doesn't exist
];
```

Check if `commands/kata/update.md` exists - if the commands directory was deleted in v1.0.9 Phase 2.2, the entire PLUGIN_EXCLUDES array may be empty or removable.
  </action>
  <verify>
```bash
# Verify build.js doesn't reference deleted files
grep -n "kata-updating" scripts/build.js
# Should return nothing

# Verify build still works
npm run build:plugin
```
  </verify>
  <done>PLUGIN_EXCLUDES updated to remove references to deleted files</done>
</task>

</tasks>

<verification>
- [ ] `ls skills/ | grep kata-updating` returns nothing
- [ ] `ls hooks/kata-check-update.js` returns error
- [ ] `ls hooks/kata-npm-statusline.js` returns error
- [ ] `ls .github/workflows/publish.yml` returns error
- [ ] `npm run build:plugin` succeeds
</verification>

<success_criteria>
1. kata-updating skill directory deleted
2. kata-check-update.js hook deleted
3. kata-npm-statusline.js hook deleted
4. publish.yml workflow deleted
5. build.js PLUGIN_EXCLUDES cleaned up
6. Plugin build still succeeds
</success_criteria>

<output>
After completion, create `.planning/phases/07-deprecate-npx-support/07-02-SUMMARY.md`
</output>
