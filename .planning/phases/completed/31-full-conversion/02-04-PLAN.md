---
phase: 02-full-conversion
plan: 04
type: execute
wave: 1
depends_on: []
files_modified:
  - skills/kata-audit-milestone/references/integration-checker-instructions.md
  - skills/kata-audit-milestone/SKILL.md
autonomous: true

must_haves:
  truths:
    - "kata-audit-milestone spawns general-purpose subagent for integration-checker"
    - "Integration-checker instructions file contains the full body content from agents/kata-integration-checker.md (no frontmatter)"
    - "Instruction file is read before Task() call and wrapped in agent-instructions tags"
  artifacts:
    - path: "skills/kata-audit-milestone/references/integration-checker-instructions.md"
      provides: "Integration checker agent instructions as skill resource"
      min_lines: 415
    - path: "skills/kata-audit-milestone/SKILL.md"
      provides: "Updated orchestrator using general-purpose subagent"
      contains: "subagent_type=\"general-purpose\""
  key_links:
    - from: "skills/kata-audit-milestone/SKILL.md"
      to: "skills/kata-audit-milestone/references/integration-checker-instructions.md"
      via: "Read tool call storing as integration_checker_instructions_content"
      pattern: "integration-checker-instructions\\.md"
---

<objective>
Migrate kata-integration-checker from custom subagent to skill resource in kata-audit-milestone.

Purpose: kata-audit-milestone has 1 agent (integration-checker) with 1 Task() call at line 117. Straightforward single-agent migration.
Output: 1 instruction file + updated SKILL.md
</objective>

<execution_context>
<!-- Executor agent has built-in instructions for plan execution and summary creation -->
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/pending/02-full-conversion/02-RESEARCH.md

Source files:
@agents/kata-integration-checker.md
@skills/kata-audit-milestone/SKILL.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Extract integration-checker instructions and update kata-audit-milestone</name>
  <files>skills/kata-audit-milestone/references/integration-checker-instructions.md, skills/kata-audit-milestone/SKILL.md</files>
  <action>
**Step A: Create references/ directory and instruction file**

Create `skills/kata-audit-milestone/references/` directory if it doesn't exist.

Read `agents/kata-integration-checker.md`. Extract everything AFTER the closing `---` of the YAML frontmatter. Copy body verbatim into `skills/kata-audit-milestone/references/integration-checker-instructions.md`.

Do NOT include frontmatter. Do NOT restructure content.

**Step B: Add Read call for instruction file in SKILL.md**

Before the Task() call at line ~109, add a read instruction:

```
Read `${SKILL_BASE_DIR}/references/integration-checker-instructions.md` and store as `integration_checker_instructions_content`.
```

If there is no `${SKILL_BASE_DIR}` reference pattern in this skill, use relative path `references/integration-checker-instructions.md` consistent with the skill's existing reference patterns.

**Step C: Update Task() call (line ~117)**

Current:
```
subagent_type="kata-integration-checker",
```

Update to:
1. Change `subagent_type="kata-integration-checker"` to `subagent_type="general-purpose"`
2. Prepend `<agent-instructions>\n{integration_checker_instructions_content}\n</agent-instructions>\n\n` to the prompt parameter

Do NOT change model selection logic.
  </action>
  <verify>
1. `head -1 skills/kata-audit-milestone/references/integration-checker-instructions.md` does NOT start with `---`
2. `wc -l skills/kata-audit-milestone/references/integration-checker-instructions.md` shows ~415+ lines
3. `grep -c 'subagent_type="kata-' skills/kata-audit-milestone/SKILL.md` returns 0
4. `grep -c 'subagent_type="general-purpose"' skills/kata-audit-milestone/SKILL.md` returns 1
5. `grep -c 'agent-instructions' skills/kata-audit-milestone/SKILL.md` returns at least 1
6. `npm run build:plugin` succeeds
  </verify>
  <done>
- integration-checker-instructions.md exists with full agent body (no frontmatter)
- Zero remaining custom subagent types in kata-audit-milestone
- Task() call uses general-purpose with agent-instructions wrapper
- Build passes
  </done>
</task>

</tasks>

<verification>
- `grep -r 'subagent_type="kata-' skills/kata-audit-milestone/` returns empty
- `grep 'subagent_type="general-purpose"' skills/kata-audit-milestone/SKILL.md` returns 1 match
- integration-checker-instructions.md body matches agents/kata-integration-checker.md body (post-frontmatter)
- `npm run build:plugin` succeeds
</verification>

<success_criteria>
1. `skills/kata-audit-milestone/references/integration-checker-instructions.md` exists with ~415+ lines
2. Zero remaining `subagent_type="kata-*"` in kata-audit-milestone
3. Task() call uses general-purpose with agent-instructions wrapper
4. Plugin build succeeds
</success_criteria>

<output>
After completion, create `.planning/phases/pending/02-full-conversion/02-04-SUMMARY.md`
</output>
