---
phase: 47-downstream-release
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - skills/kata-complete-milestone/SKILL.md
autonomous: true
user_setup: []
source_issue: "#83"

must_haves:
  truths:
    - Step 8 offers active release verification tasks instead of passive checklist
    - User sees concrete options for post-release actions (verify artifacts, run smoke test, fix issues)
    - Uses AskUserQuestion pattern consistent with other steps in the skill
    - Each offered task runs actual commands, not just displays instructions
  artifacts:
    - skills/kata-complete-milestone/SKILL.md step 8 rewritten with active task offering
  key_links:
    - HOUSE-02 from REQUIREMENTS.md
    - GitHub issue #83
---

<objective>
Replace the passive post-release checklist in kata-complete-milestone step 8 with active release task offerings that the agent performs on the user's behalf.

Purpose: GitHub issue #83 identified that milestone completion asks users if they've done release tasks instead of offering to do them. Step 0.2 already proactively generates changelog and bumps version. Step 8's post-release checklist remains passive. This plan makes step 8 offer actionable verification and fix tasks.

Output: Updated SKILL.md step 8 with active release task menu using AskUserQuestion.
</objective>

<execution_context>
<!-- Executor agent has built-in instructions for plan execution and summary creation -->
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@skills/kata-complete-milestone/SKILL.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Replace passive post-release checklist with active task offerings</name>
  <files>skills/kata-complete-milestone/SKILL.md</files>
  <action>
Rewrite step 8 ("Post-release verification") in SKILL.md. Replace the passive checklist display and simple "verified/failed/skip" question with an active task offering loop.

**New step 8 flow:**

1. Present post-release task menu using AskUserQuestion:
   - header: "Post-Release Tasks"
   - question: "Release committed. What would you like to verify?"
   - options:
     - "Run smoke tests" — Execute the project's test suite (npm test or equivalent) and report pass/fail
     - "Verify release artifacts" — Check that version files match expected version, CHANGELOG.md has entry, git tag exists
     - "Check CI/CD status" — Run `gh run list --limit 3` to show recent workflow runs and their status
     - "Everything looks good" — Skip verification, proceed to step 9

2. For each selected task, execute the actual commands:

   **"Run smoke tests":**
   ```bash
   npm test 2>&1 || echo "Tests failed"
   ```
   Report results. If failures found, offer: "Fix issues" or "Continue anyway"

   **"Verify release artifacts":**
   ```bash
   # Check version files match
   # Check CHANGELOG.md has entry for this version
   # Check git tag exists
   ```
   Report any mismatches. If issues found, offer to fix them.

   **"Check CI/CD status":**
   ```bash
   gh run list --limit 3 2>/dev/null || echo "No CI/CD runs found"
   ```
   Report status. If failures, offer to investigate.

3. After each task completes, loop back to the menu (minus completed tasks) so users can run multiple verifications.

4. When user selects "Everything looks good" or all tasks completed, proceed to step 9.

**Key constraints:**
- Keep the "Something failed" escape hatch — if user reports a failure at any point, stop and help debug
- Match AskUserQuestion patterns used in other steps (e.g., step 0.2, step 1)
- The existing step numbering (step 9 "Offer next steps") must not change
- Do NOT modify any other steps in the file

**What NOT to change:**
- Step 0.2 already handles proactive changelog/version bump (issue #83's main ask)
- Steps 0-7 and step 9 are unchanged
- Only step 8 content is rewritten
  </action>
  <verify>grep -q "Post-Release Tasks" skills/kata-complete-milestone/SKILL.md && grep -q "Run smoke tests" skills/kata-complete-milestone/SKILL.md && grep -q "Verify release artifacts" skills/kata-complete-milestone/SKILL.md</verify>
  <done>Step 8 offers active release verification tasks (smoke tests, artifact verification, CI/CD check) via AskUserQuestion with actual command execution, replacing the passive checklist. Loop allows multiple tasks before proceeding.</done>
</task>

</tasks>

<verification>
1. Step 8 uses AskUserQuestion with concrete task options
2. Each option runs actual commands (npm test, version checks, gh run list)
3. Loop allows multiple verifications before proceeding
4. "Something failed" escape hatch preserved
5. No changes to steps 0-7 or step 9
6. AskUserQuestion pattern matches existing usage in the skill
</verification>

<success_criteria>
- Step 8 offers active verification tasks instead of passive checklist
- Users can run smoke tests, verify artifacts, check CI from the menu
- Agent executes commands and reports results
- HOUSE-02 requirement satisfied
- GitHub issue #83 fully addressed
</success_criteria>

<output>
After completion, create `.planning/phases/pending/47-downstream-release/47-02-SUMMARY.md`
</output>
