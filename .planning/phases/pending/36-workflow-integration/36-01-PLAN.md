---
phase: 36-workflow-integration
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - skills/kata-add-milestone/SKILL.md
  - skills/kata-new-project/SKILL.md
  - skills/kata-discuss-phase/SKILL.md
autonomous: true
source_issue: "github:#99"
must_haves:
  truths:
    - kata-add-milestone offers optional brainstorm step between Phase 1 (Load Context) and Phase 2 (Gather Milestone Goals)
    - kata-new-project offers optional brainstorm step between Phase 3 (Deep Questioning) and Phase 4 (Write PROJECT.md)
    - kata-discuss-phase offers optional brainstorm step between step 2 (check CONTEXT.md) and step 3 (analyze gray areas)
    - Declining brainstorm at any of these three integration points continues the parent workflow without blocking
    - Each brainstorm gate uses AskUserQuestion with "Brainstorm first" and "Skip" options
  artifacts:
    - skills/kata-add-milestone/SKILL.md (modified)
    - skills/kata-new-project/SKILL.md (modified)
    - skills/kata-discuss-phase/SKILL.md (modified)
  key_links:
    - Each gate invokes /kata-brainstorm as a sub-skill when accepted
    - Brainstorm skill handles its own Agent Teams prerequisite check (parent skills do not pre-check)
    - "Skip" option continues to the next step in the parent workflow unchanged
---

<objective>
Add optional brainstorm gates to kata-add-milestone, kata-new-project, and kata-discuss-phase skills.

Purpose: Users should be able to run a structured brainstorm session at natural decision points in these workflows. Each gate follows the same pattern: AskUserQuestion offering brainstorm or skip, invoke /kata-brainstorm if accepted, continue parent workflow regardless of choice.

Output: Three modified SKILL.md files with brainstorm integration points.
</objective>

<execution_context>
<!-- Executor agent has built-in instructions for plan execution and summary creation -->
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/pending/36-workflow-integration/36-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add brainstorm gate to kata-add-milestone</name>
  <files>skills/kata-add-milestone/SKILL.md</files>
  <action>
Insert a new section between Phase 1 (Load Context) and Phase 2 (Gather Milestone Goals). Add a "## Phase 1.5: Optional Brainstorm" section.

The section content:

```markdown
## Phase 1.5: Optional Brainstorm

Use AskUserQuestion:

- header: "Brainstorm"
- question: "Brainstorm ideas before defining milestone goals?"
- options:
  - "Brainstorm first" — Run explorer/challenger brainstorm session
  - "Skip" — Continue without brainstorming

**If "Brainstorm first":**

Display:

```
Launching brainstorm session...
```

Run `/kata-brainstorm`

After brainstorm completes, continue to Phase 2.

**If "Skip":** Continue to Phase 2.
```

Insert this AFTER the "## Phase 1: Load Context" section (after its last bullet point about MILESTONE-CONTEXT.md) and BEFORE "## Phase 2: Gather Milestone Goals".

Do NOT modify any other content in the file.
  </action>
  <verify>
Read skills/kata-add-milestone/SKILL.md and verify:
1. "Phase 1.5: Optional Brainstorm" section exists between Phase 1 and Phase 2
2. AskUserQuestion has "Brainstorm" header with "Brainstorm first" and "Skip" options
3. "Brainstorm first" path invokes /kata-brainstorm
4. "Skip" path continues to Phase 2
5. All other phases unchanged
  </verify>
  <done>
kata-add-milestone SKILL.md contains Phase 1.5 with optional brainstorm gate between Load Context and Gather Milestone Goals. Both paths (brainstorm and skip) continue to Phase 2.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add brainstorm gate to kata-new-project</name>
  <files>skills/kata-new-project/SKILL.md</files>
  <action>
Insert a new section between Phase 3 (Deep Questioning) and Phase 4 (Write PROJECT.md). Add a "## Phase 3.5: Optional Brainstorm" section.

The section content:

```markdown
## Phase 3.5: Optional Brainstorm

Use AskUserQuestion:

- header: "Brainstorm"
- question: "Brainstorm directions before creating PROJECT.md?"
- options:
  - "Brainstorm first" — Run explorer/challenger brainstorm session
  - "Skip" — Continue without brainstorming

**If "Brainstorm first":**

Display:

```
Launching brainstorm session...
```

Run `/kata-brainstorm`

After brainstorm completes, continue to Phase 4.

**If "Skip":** Continue to Phase 4.
```

Insert this AFTER the "## Phase 3: Deep Questioning" section (after the "Loop until 'Create PROJECT.md' selected." line) and BEFORE "## Phase 4: Write PROJECT.md".

Do NOT modify any other content in the file.
  </action>
  <verify>
Read skills/kata-new-project/SKILL.md and verify:
1. "Phase 3.5: Optional Brainstorm" section exists between Phase 3 and Phase 4
2. AskUserQuestion has "Brainstorm" header with "Brainstorm first" and "Skip" options
3. "Brainstorm first" path invokes /kata-brainstorm
4. "Skip" path continues to Phase 4
5. All other phases unchanged
  </verify>
  <done>
kata-new-project SKILL.md contains Phase 3.5 with optional brainstorm gate between Deep Questioning and Write PROJECT.md. Both paths continue to Phase 4.
  </done>
</task>

<task type="auto">
  <name>Task 3: Add brainstorm gate to kata-discuss-phase</name>
  <files>skills/kata-discuss-phase/SKILL.md</files>
  <action>
Insert a brainstorm gate in the process steps. The current process list is:
1. Validate phase number
2. Check if CONTEXT.md exists
3. Analyze phase (identify gray areas)
4. Present gray areas
5. Deep-dive each area
6. Write CONTEXT.md
7. Offer next steps

Add a new step 2.5 between step 2 (Check CONTEXT.md) and step 3 (Analyze phase). Insert the following in the `<process>` section, after the line about checking CONTEXT.md ("2. Check if CONTEXT.md exists (offer update/view/skip if yes)") and before "3. **Analyze phase**":

```markdown
2.5. **Optional brainstorm** — Use AskUserQuestion:
   - header: "Brainstorm"
   - question: "Brainstorm approaches before analyzing gray areas?"
   - options:
     - "Brainstorm first" — Run explorer/challenger brainstorm session
     - "Skip" — Continue without brainstorming

   **If "Brainstorm first":** Display "Launching brainstorm session..." and run `/kata-brainstorm`. After brainstorm completes, continue to step 3.

   **If "Skip":** Continue to step 3.
```

Do NOT modify any other content in the file. Do NOT renumber existing steps.
  </action>
  <verify>
Read skills/kata-discuss-phase/SKILL.md and verify:
1. Step 2.5 exists between step 2 and step 3
2. AskUserQuestion has "Brainstorm" header with "Brainstorm first" and "Skip" options
3. "Brainstorm first" path invokes /kata-brainstorm
4. "Skip" path continues to step 3
5. All other steps unchanged
  </verify>
  <done>
kata-discuss-phase SKILL.md contains step 2.5 with optional brainstorm gate between CONTEXT.md check and gray area analysis. Both paths continue to step 3.
  </done>
</task>

</tasks>

<verification>
1. kata-add-milestone offers brainstorm between context loading and milestone goal gathering
2. kata-new-project offers brainstorm between questioning and PROJECT.md creation
3. kata-discuss-phase offers brainstorm between CONTEXT.md check and gray area analysis
4. All three gates use identical AskUserQuestion pattern (header: "Brainstorm", options: "Brainstorm first" / "Skip")
5. All three "Skip" paths continue the parent workflow unmodified
6. No prerequisite checking for Agent Teams in parent skills (brainstorm skill handles this)
</verification>

<success_criteria>
- [ ] kata-add-milestone has Phase 1.5 brainstorm gate
- [ ] kata-new-project has Phase 3.5 brainstorm gate
- [ ] kata-discuss-phase has step 2.5 brainstorm gate
- [ ] All gates use consistent AskUserQuestion pattern
- [ ] "Skip" never blocks parent workflow
- [ ] No other content modified in any of the three files
</success_criteria>

<output>
After completion, create `.planning/phases/pending/36-workflow-integration/36-01-SUMMARY.md`
</output>
