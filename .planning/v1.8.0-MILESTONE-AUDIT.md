---
milestone: v1.8.0
audited: 2026-02-08
status: passed
scores:
  requirements: 20/20
  phases: 3/3
  integration: 6/6
  flows: 4/4
gaps:
  requirements: []
  integration: []
  flows: []
tech_debt:
  - phase: 37-preferences-infrastructure--progressive-capture
    items:
      - "Ambiguous success criterion: '5 questions' vs 5 base + conditional follow-ups (non-blocking, interpretation matches intent)"
---

# Milestone Audit: v1.8.0 Adaptive Workflows

## Overview

**Goal:** Enable project-specific workflow customization through preferences storage, progressive capture, template overrides, and config-driven workflow variants.

**Phases:** 37 (Preferences Infrastructure & Progressive Capture), 38 (Template Overrides), 39 (Config Workflow Variants & Settings)

**Result:** All 20 requirements satisfied. All 3 phases verified and passed. Cross-phase integration verified with no gaps.

---

## Requirements Coverage

### Preferences Infrastructure (5/5)

| Req | Description | Phase | Status |
|-----|-------------|-------|--------|
| PREF-01 | Preferences stored in `.planning/preferences.json` with flat dot-notation keys | 37 | ✅ |
| PREF-02 | `read-pref.sh` centralizes parsing with resolution chain | 37 | ✅ |
| PREF-03 | `has-pref.sh` returns whether user has expressed a preference | 37 | ✅ |
| PREF-04 | `kata-new-project` scaffolds empty `preferences.json` | 37 | ✅ |
| PREF-05 | Built-in defaults table covers all known preference keys | 37 | ✅ |

### Progressive Capture (5/5)

| Req | Description | Phase | Status |
|-----|-------------|-------|--------|
| CAP-01 | Onboarding reduced to 5 essential questions | 37 | ✅ |
| CAP-02 | `model_profile` deferred to first plan-phase via check-or-ask | 37 | ✅ |
| CAP-03 | Workflow agent toggles silent-default to true with first-run notice | 37 | ✅ |
| CAP-04 | `set-config.sh` handles JSON parse, nested key set, atomic write | 37 | ✅ |
| CAP-05 | Dead `parallelization` key removed from onboarding, config schema, and settings skill | 37 | ✅ |

### Template Overrides (4/4)

| Req | Description | Phase | Status |
|-----|-------------|-------|--------|
| TMPL-01 | Five templates extracted into standalone files within skills | 38 | ✅ |
| TMPL-02 | Template resolution checks `.planning/templates/` first, falls back to plugin default | 38 | ✅ |
| TMPL-03 | Each template includes schema comment listing required fields | 38 | ✅ |
| TMPL-04 | Session-start hook detects drift between project templates and plugin schema | 38 | ✅ |

### Config Workflow Variants (6/6)

| Req | Description | Phase | Status |
|-----|-------------|-------|--------|
| WKFL-01 | `config.json` gains `workflows` section with per-skill keys | 39 | ✅ |
| WKFL-02 | `kata-execute-phase` reads `workflows.execute-phase` config | 39 | ✅ |
| WKFL-03 | `kata-verify-work` reads `workflows.verify-work` config | 39 | ✅ |
| WKFL-04 | `kata-complete-milestone` reads `workflows.complete-milestone` config | 39 | ✅ |
| WKFL-05 | Schema validation on session start warns on unknown keys, errors on invalid types | 39 | ✅ |
| WKFL-06 | `/kata-configure-settings` updated to manage preferences, workflow variants, uses accessor scripts | 39 | ✅ |

---

## Phase Verification Summary

### Phase 37: Preferences Infrastructure & Progressive Capture ✅

- **Plans:** 2/2 completed
- **Commits:** 3 (f126a8e, e6b7eb0, 12cfe8a)
- **Key deliverables:** read-pref.sh, has-pref.sh, set-config.sh, reduced onboarding, check-or-ask pattern
- **Verification:** Passed with one non-blocking note (ambiguous "5 questions" criterion)

### Phase 38: Template Overrides ✅

- **Plans:** 2/2 completed
- **Commits:** 4 (f1c5eb6, c22ce42, 099d59b, 3ad100f)
- **Score:** 29/29
- **Key deliverables:** 5 standalone templates with schema comments, resolve-template.sh, kata-template-drift.js hook, wiring in 4 orchestrator skills

### Phase 39: Config Workflow Variants & Settings ✅

- **Plans:** 3/3 completed
- **Commits:** 6 (f8f0b7c, 81f5ba9, 77b31de, 632b5b4, e8eb5fe, 1eee765)
- **Key deliverables:** 6 workflow config keys in DEFAULTS, kata-config-validator.js hook, workflow config wiring in 3 skills, settings skill rewrite (381 lines)

---

## Cross-Phase Integration

### Connection Verification (6/6)

| Connection | From | To | Status |
|------------|------|----|--------|
| Resolution pattern consistency | Phase 37 (read-pref.sh) | Phase 38 (resolve-template.sh) | ✅ Both use project-override-first |
| Accessor script usage | Phase 37 (scripts) | Phase 39 (3 workflow skills) | ✅ All 3 skills use read-pref.sh |
| Template + config co-location | Phase 38 (templates) | Phase 39 (workflow config) | ✅ Both wired in kata-execute-phase |
| DEFAULTS table coverage | Phase 37 (DEFAULTS) | Phase 39 (6 workflow keys) | ✅ All 6 keys present (23 total) |
| Hook registration | Phase 38 + 39 (hooks) | hooks.json | ✅ 3 SessionStart hooks registered |
| Settings skill coverage | Phase 37 + 39 | kata-configure-settings | ✅ Three sections: preferences, session, workflow |

### E2E Flow Verification (4/4)

| Flow | Status | Description |
|------|--------|-------------|
| New Project → First Plan | ✅ | Scaffolds preferences.json, omits model_profile, triggers check-or-ask on first plan-phase |
| Template Override | ✅ | User places override → drift detection on session start → resolve-template.sh returns override path → executor receives content |
| Workflow Config | ✅ | User configures via settings → read-pref.sh resolves → orchestrator injects into subagent → executor applies |
| Session Startup | ✅ | Three hooks fire: statusline, template drift, config validator |

---

## Tech Debt

### Phase 37 (1 item)

- **Ambiguous success criterion:** "Asks exactly 5 questions" implemented as 5 base + conditional follow-ups (GitHub issue creation, repo creation). Implementation matches plan intent. Recommend clarifying language in future phases.

### Phase 38 (0 items)

No tech debt.

### Phase 39 (0 items)

No tech debt.

---

## Deviations from Plan

No substantive deviations across any of the 3 phases. All 7 plans executed as written.

---

## Conclusion

Milestone v1.8.0 achieved its definition of done. All 20 requirements delivered across 4 categories. Cross-phase integration verified with no gaps. One minor tech debt item (ambiguous criterion wording) is non-blocking.

**Recommendation:** Proceed with milestone completion.
