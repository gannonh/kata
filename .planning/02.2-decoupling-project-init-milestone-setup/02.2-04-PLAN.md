---
phase: 02.2-decoupling-project-init-milestone-setup
plan: 04
type: execute
wave: 3
depends_on:
  - 02.2-01
  - 02.2-02
  - 02.2-03
files_modified:
  - CLAUDE.md
  - tests/skills/starting-projects.test.js
  - .planning/todos/pending/2026-01-18-separate-new-project-from-first-milestone.md
  - .planning/todos/done/2026-01-18-separate-new-project-from-first-milestone.md
autonomous: false

must_haves:
  truths:
    - "CLAUDE.md skills table reflects renamed skill"
    - "starting-projects test expects reduced output (no ROADMAP.md)"
    - "Pending todo marked as done"
  artifacts:
    - path: "CLAUDE.md"
      provides: "Updated documentation"
      contains: "kata-adding-milestones"
    - path: ".planning/todos/done/2026-01-18-separate-new-project-from-first-milestone.md"
      provides: "Completed todo"
  key_links:
    - from: "CLAUDE.md"
      to: "skills/kata-adding-milestones/SKILL.md"
      via: "skills table"
      pattern: "adding-milestones"
---

<objective>

Update documentation to reflect the new skill structure and mark related todo as complete.

Purpose: Documentation consistency and todo hygiene.
Output: Updated CLAUDE.md, fixed starting-projects test, completed todo.

</objective>

<context>

@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/02.2-decoupling-project-init-milestone-setup/02.2-01-SUMMARY.md
@.planning/phases/02.2-decoupling-project-init-milestone-setup/02.2-02-SUMMARY.md
@.planning/phases/02.2-decoupling-project-init-milestone-setup/02.2-03-SUMMARY.md

**Dependencies:** All prior plans in this phase must complete first.

</context>

<tasks>

<task type="auto">
  <name>Task 1: Update CLAUDE.md skills table</name>
  <files>CLAUDE.md</files>
  <action>
Read CLAUDE.md and find the skills table in the "Available Skills" section.

Update the table to:
1. Change `kata-starting-milestones` entry to `kata-adding-milestones`
2. Update the invocation syntax from `/kata:starting-milestones` to `/kata:adding-milestones`
3. Update the description to reflect "Add milestone to project"

Also update any other references to starting-milestones in the file (search for the term).

Example change in skills table:
```markdown
| Skill (source) | Invocation (plugin) | Purpose | Sub-agents Spawned |
| -------------- | ------------------- | ------- | ------------------ |
| `kata-adding-milestones` | `/kata:adding-milestones` | Add milestone, research, requirements, roadmap | kata-project-researcher, kata-roadmapper |
```

If there's a workflow mention or example that references starting-milestones, update those too.
  </action>
  <verify>
```bash
# Verify no starting-milestones references remain
grep -c "starting-milestones" CLAUDE.md  # Should be 0

# Verify adding-milestones is present
grep -c "adding-milestones" CLAUDE.md  # Should be >= 1
```
  </verify>
  <done>
CLAUDE.md skills table and any other references updated to use kata-adding-milestones.
  </done>
</task>

<task type="auto">
  <name>Task 2: Update starting-projects test expectations</name>
  <files>tests/skills/starting-projects.test.js</files>
  <action>
Read `tests/skills/starting-projects.test.js` and update tests to reflect the reduced scope of starting-projects:

1. The test `'creates ROADMAP.md during initialization'` should be removed or updated to expect ROADMAP.md to NOT be created
2. The test `'creates STATE.md during initialization'` should be removed or updated similarly
3. Keep the test `'creates PROJECT.md during initialization'`
4. Keep the test `'creates .planning directory'`

Since starting-projects now only creates PROJECT.md + config.json:
- Remove or update assertions that expect ROADMAP.md
- Remove or update assertions that expect STATE.md
- Keep assertions for PROJECT.md and config.json

Update the test file header comment to reflect the new behavior:
```javascript
/**
 * Tests for kata-starting-projects skill.
 *
 * Verifies that the starting-projects skill correctly initializes a new Kata
 * project with PROJECT.md and config.json only.
 *
 * NOTE: ROADMAP.md, REQUIREMENTS.md, and STATE.md are created by
 * kata-adding-milestones, not starting-projects.
 */
```

Update the test that currently checks for ROADMAP.md to instead verify it does NOT exist:
```javascript
it('does not create ROADMAP.md (handled by add-milestone)', () => {
  const result = invokeClaude(
    'new project: Build a weather CLI tool. Use TypeScript.',
    {
      cwd: testDir,
      maxBudget: config.budgets.expensive,
      timeout: config.timeouts.expensive
    }
  );

  assertNoError(result);
  assertSkillInvoked(result);

  // ROADMAP.md should NOT be created by starting-projects
  // It's created by add-milestone
  const roadmapPath = join(testDir, '.planning', 'ROADMAP.md');
  if (existsSync(roadmapPath)) {
    throw new Error('ROADMAP.md should not be created by starting-projects');
  }
});
```
  </action>
  <verify>
```bash
# Verify test file updated
grep -c "add-milestone" tests/skills/starting-projects.test.js  # Should be >= 1

# Verify ROADMAP expectation changed
grep "ROADMAP" tests/skills/starting-projects.test.js | head -3
```
  </verify>
  <done>
starting-projects test expects only PROJECT.md + config.json, not ROADMAP/STATE.
  </done>
</task>

<task type="auto">
  <name>Task 3: Mark pending todo as done</name>
  <files>
.planning/todos/pending/2026-01-18-separate-new-project-from-first-milestone.md
.planning/todos/done/2026-01-18-separate-new-project-from-first-milestone.md
  </files>
  <action>
Move the todo file from pending to done and add completion note:

```bash
mkdir -p .planning/todos/done
mv .planning/todos/pending/2026-01-18-separate-new-project-from-first-milestone.md .planning/todos/done/
```

Read the moved file and append a completion section:

```markdown

---

## Resolution

**Completed:** 2026-01-26
**Phase:** 02.2-decoupling-project-init-milestone-setup

Implemented as specified:
1. `/kata:new-project` (starting-projects) now creates only PROJECT.md + config.json
2. `/kata:add-milestone` (renamed from starting-milestones) handles research, requirements, roadmap
3. Flow: project-new → add-milestone → plan-phase → execute-phase

Mental model is now clean: project → milestones → phases → plans
```
  </action>
  <verify>
```bash
# Verify todo moved
[ -f .planning/todos/done/2026-01-18-separate-new-project-from-first-milestone.md ] && echo "Todo moved to done"
[ ! -f .planning/todos/pending/2026-01-18-separate-new-project-from-first-milestone.md ] && echo "Todo removed from pending"

# Verify completion note added
grep "Resolution" .planning/todos/done/2026-01-18-separate-new-project-from-first-milestone.md
```
  </verify>
  <done>
Todo moved from pending to done with completion note.
  </done>
</task>

<task type="auto">
  <name>Task 4: Commit documentation updates</name>
  <files>
CLAUDE.md
tests/skills/starting-projects.test.js
.planning/todos/
  </files>
  <action>
Stage and commit all documentation changes:

```bash
git add CLAUDE.md tests/skills/starting-projects.test.js .planning/todos/
git commit -m "$(cat <<'EOF'
docs(02.2-04): update documentation for skill rename

- CLAUDE.md: Update skills table (starting-milestones → adding-milestones)
- tests/starting-projects.test.js: Expect only PROJECT.md + config.json
- Mark todo as done: separate-new-project-from-first-milestone

Phase 2.2 complete: Project init decoupled from milestone creation.

Co-Authored-By: Claude <noreply@anthropic.com>
EOF
)"
```
  </action>
  <verify>
```bash
git log -1 --oneline
git show --stat HEAD
```
  </verify>
  <done>
All documentation changes committed.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete project init / milestone separation with renamed skill</what-built>
  <how-to-verify>
1. **Verify skill structure:**
   ```bash
   ls skills/kata-adding-milestones/
   ls skills/kata-starting-milestones/ 2>/dev/null  # Should fail (not found)
   ```

2. **Verify starting-projects reduced scope:**
   - Read `skills/kata-starting-projects/SKILL.md`
   - Confirm "Creates:" section lists only PROJECT.md and config.json
   - Confirm "Next Up" mentions `/kata:add-milestone`

3. **Verify adding-milestones has full flow:**
   - Read `skills/kata-adding-milestones/SKILL.md`
   - Confirm research, requirements, roadmap phases exist
   - Confirm first milestone detection logic

4. **Run tests (optional):**
   ```bash
   npm test -- --grep "starting-projects"
   npm test -- --grep "adding-milestones"
   ```

5. **Test the flow (optional - manual):**
   - In a new directory, run `/kata:new-project`
   - Verify it creates only PROJECT.md + config.json
   - Verify it prompts for `/kata:add-milestone`
  </how-to-verify>
  <resume-signal>Type "verified" to complete phase, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>

```bash
# Full verification suite
echo "=== Skill Structure ==="
ls skills/ | grep milestone
ls skills/kata-adding-milestones/

echo "=== CLAUDE.md ==="
grep -c "adding-milestones" CLAUDE.md
grep -c "starting-milestones" CLAUDE.md  # Should be 0

echo "=== Tests ==="
ls tests/skills/*milestone*

echo "=== Todo ==="
ls .planning/todos/done/*separate*
ls .planning/todos/pending/*separate* 2>/dev/null  # Should fail
```

</verification>

<success_criteria>

- [ ] CLAUDE.md skills table updated to kata-adding-milestones
- [ ] No "starting-milestones" references in CLAUDE.md
- [ ] starting-projects test expects only PROJECT.md + config.json
- [ ] Todo moved from pending to done with completion note
- [ ] All changes committed
- [ ] Human verification checkpoint passed

</success_criteria>

<output>

After completion, create `.planning/phases/02.2-decoupling-project-init-milestone-setup/02.2-04-SUMMARY.md`

</output>
